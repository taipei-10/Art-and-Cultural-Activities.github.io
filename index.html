<!doctype html>
<html lang="zh-Hant" class="scroll-smooth">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>台北藝文・智慧搜尋</title>

<!-- 外部樣式與套件 -->
<link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet" />
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
<script src="https://unpkg.com/topojson-client@3"></script>

<!-- 引用自訂樣式 -->
<link rel="stylesheet" href="./styles.css" />

<script>
  tailwind.config = {
    theme:{extend:{colors:{brand:'#0ea5e9',brandDark:'#0284c7'}}},
    darkMode:'class'
  }
</script>
</head>

<body class="bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100">
<div class="max-w-6xl mx-auto p-4">

  <header class="mb-4 flex items-start justify-between gap-3">
    <div>
      <h1 class="text-2xl md:text-3xl font-semibold tracking-tight">台北市最近幾天藝文活動</h1>
      <p class="text-sm text-gray-600 dark:text-gray-400">地圖含座標、行政區點選、即時路徑規劃</p>
    </div>
    <div class="flex items-center gap-2">
      <button id="darkToggle" class="px-3 py-2 text-sm border rounded-md hover:bg-gray-50 dark:hover:bg-gray-800">深淺切換</button>
      <a href="#results" class="px-3 py-2 text-sm border rounded-md hover:bg-gray-50 dark:hover:bg-gray-800">快速看清單</a>
    </div>
  </header>

  <section class="sticky top-0 z-30 bg-white/80 dark:bg-gray-900/80 backdrop-blur border rounded-md p-3 mb-4 shadow-sm">
    <div class="grid md:grid-cols-3 gap-3">
      <div class="md:col-span-2 flex gap-2">
        <div class="flex-1 relative">
          <input id="q" class="w-full border rounded-md pl-9 pr-3 py-2 outline-none focus:ring-2 focus:ring-brand/40 dark:bg-gray-900 dark:border-gray-700" placeholder="輸入：明後天 士林 展覽 300元以下" />
          <svg class="w-5 h-5 absolute left-2.5 top-2.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m21 21-4.3-4.3M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"/></svg>
        </div>
        <button id="btn" class="px-4 py-2 bg-black text-white rounded-md hover:opacity-90 dark:bg-gray-200 dark:text-gray-900">搜尋</button>
      </div>
      <div class="grid grid-cols-3 gap-2">
        <select id="type" class="border rounded-md px-2 py-2 dark:bg-gray-900 dark:border-gray-700">
          <option value="">全部類型</option><option>展覽</option><option>表演</option>
          <option>講座</option><option>電影</option><option>市集</option>
        </select>
        <select id="days" class="border rounded-md px-2 py-2 dark:bg-gray-900 dark:border-gray-700">
          <option value="3" selected>近3天</option><option value="7">近7天</option>
        </select>
        <select id="radius" class="border rounded-md px-2 py-2 dark:bg-gray-900 dark:border-gray-700">
          <option value="2">2km</option><option value="5" selected>5km</option><option value="10">10km</option>
        </select>
      </div>
    </div>
  </section>

  <section class="rounded-md border mb-4 relative overflow-hidden">
    <div id="map"></div>
    <div class="map-tools">
      <button id="btnGeo" class="tool-btn" title="定位到我"><svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm0-6a1 1 0 0 1 1 1v2.06a7.002 7.002 0 0 1 5.94 5.94H21a1 1 0 1 1 0 2h-2.06A7.002 7.002 0 0 1 13 18.94V21a1 1 0 1 1-2 0v-2.06A7.002 7.002 0 0 1 5.06 13H3a1 1 0 1 1 0-2h2.06A7.002 7.002 0 0 1 11 5.06V3a1 1 0 0 1 1-1Z"/></svg></button>
      <button id="btnClearRoute" class="tool-btn" title="清除路線"><svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M5 7h14v2H5V7Zm0 4h10v2H5v-2Zm0 4h14v2H5v-2Z"/></svg></button>
    </div>
    <div id="coord" class="absolute right-2 top-2 bg-white/90 dark:bg-gray-800/80 border dark:border-gray-700 rounded px-2 py-1 text-xs font-mono"></div>
    <div id="mapToast" class="hidden absolute left-1/2 -translate-x-1/2 bottom-3 px-3 py-1.5 rounded bg-black/80 text-white text-xs"></div>
  </section>

  <section class="grid md:grid-cols-3 gap-4 items-start">
    <aside class="md:col-span-1 space-y-3">
      <div class="rounded-md border p-3">
        <label class="block text-sm mb-2">票價上限（NT$）</label>
        <input id="pmax" type="number" inputmode="numeric" class="border rounded-md w-full px-3 py-2 dark:bg-gray-900 dark:border-gray-700" placeholder="如 300" />
      </div>
      <div class="rounded-md border p-3">
        <label class="block text-sm mb-2">行政區（依圖層）</label>
        <select id="dist" class="border rounded-md w-full px-3 py-2 dark:bg-gray-900 dark:border-gray-700">
          <option value="">全部</option>
        </select>
      </div>
      <div class="flex gap-2">
        <button id="reset" class="flex-1 px-3 py-2 border rounded-md hover:bg-gray-50 dark:hover:bg-gray-800">清除條件</button>
        <button id="recenter" class="px-3 py-2 border rounded-md hover:bg-gray-50 dark:hover:bg-gray-800">回到台北</button>
      </div>
      <div id="routeInfo" class="text-xs text-gray-600 dark:text-gray-400"></div>
      <div id="alert" class="hidden text-xs mt-2 p-2 rounded bg-red-50 text-red-700 border border-red-200 dark:bg-red-900/20 dark:text-red-300 dark:border-red-800"></div>
    </aside>

    <main id="results" class="md:col-span-2 space-y-3">
      <div id="skeletonWrap" class="space-y-3">
        <div class="border rounded-md p-3 bg-white dark:bg-gray-900">
          <div class="h-5 w-48 skeleton rounded mb-2"></div>
          <div class="h-4 w-full skeleton rounded mb-1"></div>
          <div class="h-4 w-5/6 skeleton rounded mb-3"></div>
          <div class="h-8 w-40 skeleton rounded"></div>
        </div>
      </div>
    </main>
  </section>
</div>

<!-- 原本的 JavaScript 保留不變 -->
<script>
/* …原本 JavaScript 程式碼貼在這裡… */
</script>

</body>
</html>
